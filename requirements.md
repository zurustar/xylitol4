RFC3261に準拠したステートフルなSIPプロキシを実装すること。

- INVITEおよび非INVITE要求を対象としたトランザクションをRFC3261の状態機械に従って管理する。
- トランスポート層、トランザクション層、トランザクションユーザ層を分離し、各レイヤ間はバッファ付きキューで疎結合に接続する。
- プロキシは転送時にViaヘッダの追加・削除やMax-Forwardsの減算など、基本的なSIPプロキシ処理を行う。
- 再送要求に対しては保持している応答を再送するなど、ステートフルに振る舞う。
- REGISTER要求をローカルで処理し、ユーザディレクトリに基づいたHTTP Digest認証を行うレジストラ機能を備える。未認証の要求には401/WWW-Authenticateで応答し、無効な資格情報には403、存在しないユーザには404を返す。
- レジストラはContactヘッダのexpiresパラメータや全体のExpires値を解釈し、登録バインディングの追加・更新・削除および`*`コンタクトによる解除に対応する。成功時には現在のバインディング一覧とToタグを含む200応答を生成する。
- レジストラおよびプロキシが利用するユーザディレクトリとしてSQLiteバックエンドのストアを提供し、Lookup/AllUsers API経由で資格情報と連絡先URIを取得できるようにする。テストでは専用のインメモリSQLiteドライバでCGO不要に動作させる。
- `cmd/sip-proxy`としてUDPソケットに接続する実行可能エントリポイントを提供し、`--listen`/`--upstream`/`--upstream-bind`/`--route-ttl`/`--user-db`の各フラグで構成できるようにする。`--upstream`と`--user-db`は必須とし、起動時にユーザDBを開いて全ユーザ情報を読み込む。
- エントリポイントは受信したパケットを`sip.ParseMessage`でデコードしてプロキシへ渡し、トランザクションキーに基づき下流アドレスをTTL付きで保持するルータを使って応答を送り返す。SIGINT/SIGTERMを受けた場合はゴルーチンを停止させ、安全にシャットダウンする。
